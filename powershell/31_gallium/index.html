
<!doctype html>
<html lang="fi" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lukeminen/">
      
      
        <link rel="next" href="../38_strontium/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>💡 Gallium - Skriptiohjelmointi</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gallium" class="md-skip">
          Hyppää sisältöön
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Ylätunniste">
    <a href="../.." title="Skriptiohjelmointi" class="md-header__button md-logo" aria-label="Skriptiohjelmointi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skriptiohjelmointi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              💡 Gallium
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Hae" placeholder="Hae" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Haku">
        
        <button type="reset" class="md-search__icon md-icon" title="Tyhjää" aria-label="Tyhjää" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Aloitetaan hakua
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigaatio" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Skriptiohjelmointi" class="md-nav__button md-logo" aria-label="Skriptiohjelmointi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Skriptiohjelmointi
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tervetuloa kurssille
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bash
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Bash
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bash/aloita/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bash 101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bash/lukeminen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lukeminen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bash/31_gallium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    💡 Gallium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bash/38_strontium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎆 Strontium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bash/96_curium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👩‍🔬 Curium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bash/99_einsteinium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👨‍🔬 Einsteinium
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PowerShell
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            PowerShell
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aloita/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PowerShell 101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lukeminen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lukeminen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    💡 Gallium
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    💡 Gallium
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tarpit" class="md-nav__link">
    <span class="md-ellipsis">
      Tärpit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tärpit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avainsanat" class="md-nav__link">
    <span class="md-ellipsis">
      Avainsanat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#muuttujat" class="md-nav__link">
    <span class="md-ellipsis">
      Muuttujat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Muuttujat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynaaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Dynaaminen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaihtaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Vaihtaminen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tyypittaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Tyypittäminen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selvittaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Selvittäminen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drives" class="md-nav__link">
    <span class="md-ellipsis">
      Drives
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vianetsinta" class="md-nav__link">
    <span class="md-ellipsis">
      Vianetsintä
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vianetsintä">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strictmode" class="md-nav__link">
    <span class="md-ellipsis">
      StrictMode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erroractionpreference" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorActionPreference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-something" class="md-nav__link">
    <span class="md-ellipsis">
      Write-Something
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debuggaus" class="md-nav__link">
    <span class="md-ellipsis">
      Debuggaus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tehtavat" class="md-nav__link">
    <span class="md-ellipsis">
      Tehtävät
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38_strontium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎆 Strontium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../96_curium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👩‍🔬 Curium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../99_einsteinium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👨‍🔬 Einsteinium
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/aloita/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python 101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/lukeminen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lukeminen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/31_gallium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    💡 Gallium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/38_strontium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎆 Strontium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/96_curium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👩‍🔬 Curium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/99_einsteinium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👨‍🔬 Einsteinium
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ansible
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Ansible
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/aloita/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ansible 101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/lukeminen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lukeminen
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/31_gallium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    💡 Gallium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/38_strontium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    🎆 Strontium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/96_curium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👩‍🔬 Curium
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ansible/99_einsteinium/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    👨‍🔬 Einsteinium
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exercises/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tehtäväkooste
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Sisällysluettelo">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Sisällysluettelo
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tarpit" class="md-nav__link">
    <span class="md-ellipsis">
      Tärpit
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tärpit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avainsanat" class="md-nav__link">
    <span class="md-ellipsis">
      Avainsanat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#muuttujat" class="md-nav__link">
    <span class="md-ellipsis">
      Muuttujat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Muuttujat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynaaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Dynaaminen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vaihtaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Vaihtaminen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tyypittaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Tyypittäminen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selvittaminen" class="md-nav__link">
    <span class="md-ellipsis">
      Selvittäminen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drives" class="md-nav__link">
    <span class="md-ellipsis">
      Drives
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vianetsinta" class="md-nav__link">
    <span class="md-ellipsis">
      Vianetsintä
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Vianetsintä">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#strictmode" class="md-nav__link">
    <span class="md-ellipsis">
      StrictMode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erroractionpreference" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorActionPreference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-something" class="md-nav__link">
    <span class="md-ellipsis">
      Write-Something
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debuggaus" class="md-nav__link">
    <span class="md-ellipsis">
      Debuggaus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tehtavat" class="md-nav__link">
    <span class="md-ellipsis">
      Tehtävät
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="gallium">💡 Gallium</h1>
<h2 id="tarpit">Tärpit</h2>
<h3 id="avainsanat">Avainsanat</h3>
<p>Aivan kuten Bashissä, myös PowerShellissä on varattuja sanoja, joita ei voi käyttää muuttujaniminä. Tässä on lista niistä:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>The following are the reserved words in PowerShell:
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    assembly         exit            process
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    base             filter          public
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    begin            finally         return
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    break            for             sequence
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    catch            foreach         static
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    class            from (*)        switch
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    command          function        throw
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    configuration    hidden          trap
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    continue         if              try
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    data             in              type
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    define (*)       inlinescript    until
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    do               interface       using
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>    dynamicparam     module          var (*)
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    else             namespace       while
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    elseif           parallel        workflow
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>    end              param
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    enum             private
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    (*) These keywords are reserved for future use.
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Mistä nämä löytyivät?</p>
<p>Olettaen että Help on päivitetty, saat nämä auki komennolla:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">help</span> <span class="n">about_reserved_words</span>
</span></code></pre></div>
<p>Komennon help löytyy online: <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_reserved_words">about_Reserved_Words</a>.</p>
</div>
<h3 id="muuttujat">Muuttujat</h3>
<p>Koko totuus löytyy PowerShellin dokumentaatiosta (esim. <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_variables">about_Variables</a>), mutta alla on pikaohje, jolla pääset alkuun.</p>
<h4 id="dynaaminen">Dynaaminen</h4>
<p>PowerShell on dynaamisesti tyypitetty kieli. Tämä tarkoittaa, että sama muuttuja voi vaihtua kokoluvusta merkkijonoksi ja niin edelleen, ja tyyppi päätellään automaattisesti. Merkin <code>=</code> vasemmalle puolella on muuttujanimi, oikealla on lauseke: <code>{variable} = {expression}</code>. Lauseke voi olla literaali, kuten <code>123</code>, tai sisältää operaattoreita, kuten <code>100 + 125 - 2</code>. Oli niin tai näin, tulkki evaluioi <code>=</code>-merkin oikealla puolella olevan lausekkeen ja yrittää sijoittaa kyseisen arvon muuttujaan. Muuttuja saa tämän tyypin.</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">$x</span> <span class="p">=</span> <span class="n">1</span>            <span class="c"># Kokonaisluku (Int32)</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nv">$x</span> <span class="p">=</span> <span class="n">1</span> <span class="p">+</span> <span class="n">2</span> <span class="p">-</span> <span class="n">1</span>    <span class="c"># ... kuten tämäkin.</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nv">$x</span> <span class="p">=</span> <span class="n">3</span><span class="p">.</span><span class="n">12</span>         <span class="c"># Liukuluku (Double)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nv">$x</span> <span class="p">=</span> <span class="s2">&quot;abc&quot;</span>        <span class="c"># Merkkijono (String)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nv">$x</span> <span class="p">=</span> <span class="p">@(</span><span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="n">42</span><span class="p">)</span> <span class="c"># Taulukko (Array)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="nv">$x</span> <span class="p">=</span> <span class="p">@{</span><span class="n">a</span><span class="p">=</span><span class="n">1</span><span class="p">;</span><span class="n">b</span><span class="p">=</span><span class="n">2</span><span class="p">}</span>   <span class="c"># Hajautustaulu (Hash table)</span>
</span></code></pre></div>
<h4 id="vaihtaminen">Vaihtaminen</h4>
<p>Tyypin voi myös itse määrätä, jolloin se käytännössä castataan kyseiseksi muuttujaksi. Huomaa, että itse muuttuja on kuitenkin yhä dynaaminen:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">$x</span> <span class="p">=</span> <span class="no">[byte]</span> <span class="n">255</span>      <span class="c"># Nyt se onkin tavu (Byte)</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nv">$x</span> <span class="p">=</span> <span class="no">[int]</span> <span class="n">255</span>       <span class="c"># ... eiku kokonaisluku (Int32)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="nv">$x</span> <span class="p">=</span> <span class="no">[string]</span> <span class="s2">&quot;abc&quot;</span>  <span class="c"># ... eiku merkkijono (String)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c"># Huomaa myös -as operaattori, joka palauttaa null jos castaus ei onnistu</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="nv">$y</span> <span class="p">=</span> <span class="nv">$x</span> <span class="o">-as</span> <span class="no">[int]</span> <span class="c"># ... null, koska &quot;abc&quot; ei taivu luvuksi</span>
</span></code></pre></div>
<h4 id="tyypittaminen">Tyypittäminen</h4>
<p>Voit myös käskeä muuttujan käyttämään tiettyä tyyppiä nyt ja jatkossa. Erona yllä olevaan on, että <code>[type]$variable</code> on nyt vasemmalla puolella <code>=</code>-merkkiä. Kaikki muuttujaan sijoitetut arvot pyritään jatkossa muuttamaan tähän tyyppiin. Jos muutos ei onnistu, saat virheen.</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="no">[string]</span><span class="nv">$x</span> <span class="p">=</span> <span class="n">1</span>      <span class="c"># Kerran merkkijono, aina merkkijono</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="nv">$x</span> <span class="p">=</span> <span class="s2">&quot;Kissa&quot;</span>        <span class="c"># ... ja yhä</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="nv">$x</span> <span class="p">=</span> <span class="n">1</span>              <span class="c"># ... ja yhä</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="no">[int]</span><span class="nv">$y</span> <span class="p">=</span> <span class="n">12</span> <span class="c"># Nro</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="nv">$y</span> <span class="p">=</span> <span class="s2">&quot;Koira&quot;</span> <span class="c"># Virhe</span>
</span></code></pre></div>
<p>Sokeasti automaattiseen tyypitykseen luottamisessa on omat riskinsä. Mieti tarkkaan, mitä seuraavassa tapahtuu:</p>
<div class="language-text highlight"><span class="filename">🐳 PowerShell</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>PS /&gt; 4 + &quot;2&quot;
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>6
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>PS /&gt; &quot;4&quot; + 2
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>42
</span></code></pre></div>
<p>Skriptejä kirjoittaessa tuskin tarvitset muita <em>simple typejä</em> kuin yllä listatut, mutta loput löytyvät esimerkiksi <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/types#835-simple-types">C# Docs: Simple Types</a> tai <a href="https://devblogs.microsoft.com/scripting/understanding-numbers-in-powershell/">DevBlogs: Understanding Numbers in PowerShell</a>. Näiltä sivuilta selviää myös numeraalisten tyyppien minimi- ja maksimiarvot, mikäli tarvitset kertausta asiasta.</p>
<h4 id="selvittaminen">Selvittäminen</h4>
<p>Jos olet epävarma, mitä jotakin cmdlet palauttaa, voit aina selvittää sen näin:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c"># Näin saat myös metodit ja parametrit esille</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nb">Get-Location</span> <span class="p">|</span> <span class="nb">Get-Member</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="c"># Näin saat tyypin tiedot</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="p">(</span><span class="nb">Get-Location</span><span class="p">).</span><span class="n">GetType</span><span class="p">()</span>      <span class="c"># itsessään System.RuntimeType</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="p">(</span><span class="nb">Get-Location</span><span class="p">).</span><span class="n">GetType</span><span class="p">().</span><span class="n">Name</span> <span class="c"># itsessään String</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="c"># Jos palautunut arvo on jo muuttujassa</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="nv">$var</span> <span class="p">|</span> <span class="nb">Get-Member</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="c"># tai</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="nv">$var</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="drives">Drives</h3>
<p>PowerShellissä on käsite "drive", joka on hieman erilainen kuin Linuxin tiedostojärjestelmä. Drive on käytännössä jokin abstrakti käsite, joka voi olla esimerkiksi tiedostojärjestelmä, rekisteri tai jokin muu. Voit listata kaikki drivet komennolla <code>Get-PSDrive</code>. Voit vaihtaa driveä komennolla <code>Set-Location</code>. Alla on komentoja, joissa aloitetaan /home/-hakemistosta, vaihdetaan env:-driveen ja listataan muuttujia, josta vaihdetaan Variable:-driveen, ja lopulta takaisin kotoisin tieodstojärjestelmän puolelle.</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nb">cd </span><span class="p">/</span><span class="n">home</span>         <span class="c"># Aloitetaan tästä (1)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="nb">cd </span><span class="n">env</span><span class="p">:</span>          <span class="c"># Vaihdetaan env:-driveen (2) </span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="nb">Get-ChildItem</span>    <span class="c"># Listataan muuttujat</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="nb">cd </span><span class="n">Variable</span><span class="p">:</span>     <span class="c"># Vaihdetaan Variable:-driveen</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="nb">cd </span><span class="p">/</span>             <span class="c"># Vaihdetaan takaisin kotihakemistoon</span>
</span></code></pre></div>
<ol>
<li>Huomaa, että <code>cd</code> on Alias <code>Set-Location</code>-komentoon.</li>
<li><code>env:</code>-drive sisältää ympäristömuuttujat. Huomaa, että Bashissä nämä ovat ihan vain muuttujia samassa namespacessa (esim. <code>$PATH</code>). PowerShell abstrahoi nämä omaksi drivekseen.</li>
</ol>
<h2 id="vianetsinta">Vianetsintä</h2>
<p>Voimme käyttää Bash-kielestä tuttuja tapoja, mutta luonnolliseti niille on eri syntaksi. Tuttu <code>set -u</code> korvautuu StrictMode-asetuksella ja <code>set -e</code> korvautuu ErrorActionPreference-asetuksella.</p>
<h3 id="strictmode">StrictMode</h3>
<p>PowerShellin StrictMode on hieman monimutkaisempi kuin Bashin <code>set -u</code> (eli <code>nounset</code>). Käytännössä se kuitenkin esimerkiksi tarkistaa, että et yritä kutsua käyttämättömiä muuttujia. Voit kytkeä skriptissä sen päälle näin:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">Set-StrictMode</span> <span class="n">-Version</span> <span class="n">2</span><span class="p">.</span><span class="n">0</span>
</span></code></pre></div>
<p>Voit käyttää myös muita versioita, 1.0 tai 3.0. Tutustu niiden dokumentaatioon: <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/set-strictmode">Set-StrictMode</a></p>
<details class="note">
<summary>Kuinka testata?</summary>
<p>Luo ja aja tiedosto:</p>
<div class="language-powershell highlight"><span class="filename">stictmode_yes.ps1</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">Set-StrictMode</span> <span class="n">-Version</span> <span class="n">2</span><span class="p">.</span><span class="n">0</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="nb">Write-Host</span> <span class="s2">&quot;Starting script with strict mode enabled...&quot;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="nb">Write-Host</span> <span class="s2">&quot;We are referencing: $undefinedVar&quot;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nb">Write-Host</span> <span class="s2">&quot;This will never print.&quot;</span>
</span></code></pre></div>
<p>Luo myös tiedosto <code>strictmode_no.ps1</code>, joka on muutoin identtinen, mutta muokkaa riviä yksi. Aseta se muotoon <code>Set-StrictMode -Off</code>. Aja molemmat tiedostot ja vertaa tuloksia.</p>
</details>
<h3 id="erroractionpreference">ErrorActionPreference</h3>
<p>PowerShellissä on useita preference-muuttujia (ks. about_Preference_Variables), joilla voit säätää, kuinka PowerShell käyttäytyy. Näistä <code>set -e</code>:tä eli <code>errexit</code>-toiminnallisuutta vastaa parhaiten <code>ErrorActionPreference</code>. Voit asettaa sen arvoksi <code>Stop</code>, jolloin skripti pysähtyy ensimmäiseen virheeseen. Vakioarvo on <code>Continue</code>, jolloin skripti jatkaa virheistä huolimatta.</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="s2">&quot;Stop&quot;</span>
</span></code></pre></div>
<details class="note">
<summary>Kuinka testata?</summary>
<p>Luo ja aja tiedosto:</p>
<div class="language-powershell highlight"><span class="filename">preference_stop.ps1</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="s2">&quot;Stop&quot;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nb">Write-Host</span> <span class="s2">&quot;Starting script with ErrorActionPreference set to Stop...&quot;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="nb">Set-Location</span> <span class="n">-Path</span> <span class="s2">&quot;/thisdoesnotexist&quot;</span> <span class="n">2</span><span class="p">&gt;</span><span class="nv">$null</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="nb">Write-Host</span> <span class="s2">&quot;This will never print.&quot;</span>
</span></code></pre></div>
<p>Luo myös tiedosto <code>preference_continue.ps1</code>, joka on muutoin identtinen, mutta muokkaa riviä yksi. Aseta se muotoon <code>$ErrorActionPreference = "Continue"</code>. Aja molemmat tiedostot ja vertaa tuloksia.</p>
</details>
<h3 id="write-something">Write-Something</h3>
<p>Yksi luonnollinen tapa debugata lähes mitä tahansa ohjelmointikieltä on tulostaa muuttujien arvo kesken skriptin terminaaliin. Tämä ei kuulosta rakettitieteeltä, mutta voi olla hyvin tehokas tapa debugata. Bashin kanssa ehkä opit, että <code>echo</code>-komentoja on ärsyttävä lisätä ja poistaa tarpeen mukaan. Käsin lisätty <code>-v</code> option (verbose) auttaa, mutta vaatii argumenttien parsimista ja if-lausekkeita. Yksi tapa on ohjata komennot <code>stderr</code>-virtaan, mutta se on sinänsä vääräoppista, että debug-viestit eivät varsinaisesti ole virheitä.</p>
<p>PowerShell tarjoaa tähän ratkaisun tukemalla useita eri virtoja. Näitä on useita. Alla olevassa esimerkissä käytämme virtoja: Success (1), Verbose (4) ja Warning(3). Verbose ei tulostu ruudulle tavallisesti, mutta jos asetat preference variablen <code>VerbosePreference</code> arvoksi <code>Continue</code>, näet myös Debug-virran tulosteet. Lue lisää ohjeista about_Output_Streams sekä about_Preference_Variables.</p>
<div class="language-powershell highlight"><span class="filename">streams.ps1</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nb">Write-Output</span> <span class="s2">&quot;I am typical output!&quot;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="nb">Write-Verbose</span> <span class="s2">&quot;Ah, you must have VerbosePreference set up properly! 🕵️‍♀️&quot;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="nb">Write-Warning</span> <span class="s2">&quot;Warning! Warning! 🚨&quot;</span>
</span></code></pre></div>
<h3 id="debuggaus">Debuggaus</h3>
<p>PowerShellissä on myös debugger, joka on käytettävissä Visual Studion Code -editorissa, olettaen, että PowerShell Extension on asennettuna. Voit käynnistää sen painamalla <code>F5</code>. Se on erityisen hyödyllinen breakpoint-toiminnon avulla esimerkiksi silmukoiden debuggaamisessa.</p>
<p>Tutustumme tämän käyttöön live-tunneilla.</p>
<h2 id="tehtavat">Tehtävät</h2>
<details class="question">
<summary>Tehtävä: Devausympäristö ja runpwsh.sh</summary>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Huomaa, että jos työskentelet siten, että Windows on host-käyttöjärjestelmäsi, voit kirjoittaa tämän saman skriptin PowerShell-kielellä. Tässä esimerkissä käytetään Bashia, koska kurssin oletuksena on Linux-host.</p>
</div>
<p>PowerShell-osion ensimmäisessä koodaustehtävässä luot itsellesi devausympäristön. Pohja tätä varten sinulla pitäisi olla jo olemassa Bash-osiosta. Käytännössä luot:</p>
<ul>
<li>Hakemistorakenteen tehtävien vastauksia varten</li>
<li>Skriptin <code>runpwsh.sh</code>, joka joko:<ul>
<li>Ajaa valitun skriptin kontissa</li>
<li>Käynnistää interaktiivisen shellin (pwsh)</li>
</ul>
</li>
<li>Varmistat, että kaikki on versionhallinnassa</li>
</ul>
<p>Jatka samassa repositoriossa työskentelyä, missä olet jo aiemmin työskenenlly. Jatka rakennetta seuraavanalaisesti:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>johnanderton
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>├── README.md
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>├── bash/
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>├── pwsh
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>|   ├── README.md
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>│   ├── runpwsh.sh                  # Uusi tiedosto
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>│   ├── .help/powershell-help/      # Uusi hakemisto
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>│   └── scripts/                    # Uusi hakemisto
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>└── python
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>    └── .gitkeep
</span></code></pre></div>
<p>Tiedoston <code>runpwsh.sh</code> luominen olisi hyvää kertausta Bash-osiosta, mutta jotta voimme keskittyä PowerShell-osioon, voit ladata skriptin tämän repositorion polusta: <a href="https://raw.githubusercontent.com/sourander/skriptiohjelmointi/refs/heads/main/exercise-assets/scripts/runpwsh.sh">gh:sourander/skriptiohjelmointi/exercise-assets/scripts/runpwsh.sh</a></p>
</details>
<details class="question">
<summary>Tehtävä: PowerShell Hello World</summary>
<p>Luo skripti `hello.ps1, joka tulostaa terminaaliin tekstin "Hello World!".</p>
<p>Sijoita se repositorion juuresta lukien relatiiviseen polkuun <code>pwsh/scripts/hello.ps1</code>. Aja skripti <code>./runpwsh.sh scripts/hello.ps1</code> ja varmista, että se tulostaa "Hello World!". Käytä alla olevaa templaattia:</p>
<div class="language-powershell highlight"><span class="filename">hello.ps1</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c"># IMPLEMENT</span>
</span></code></pre></div>
</details>
<details class="question">
<summary>Tehtävä: PowerShell Turboahdettu Hello World</summary>
<div class="language-powershell highlight"><span class="filename">hello_turbo.ps1</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="cm">&lt;#</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="sd">.SYNOPSIS</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="cm">    Prints &quot;Hello World!&quot; to the terminal.</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="cm">... ADD MORE HELP HERE ...</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="cm">#&gt;</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="c"># IMPLEMENT</span>
</span></code></pre></div>
<p>Jalosta yllä näkyvää skriptin alkua. Lopullisen skriptin tulisi:</p>
<ul>
<li>tulostaa absoluuttinen polku työhakemistoon</li>
<li>tulostaa absoluuttinen polku skriptin sijaintiin</li>
<li>tulostaa <code>PSEdition</code>-muuttujan arvon, mutta vain Debug-virtaan.</li>
<li>tukea <code>Get-Help</code>-komentoa. Implementoi ainakin:<ul>
<li>Synopsis (yllä)</li>
<li>Description</li>
<li>Example</li>
</ul>
</li>
</ul>
<p>Ohjelman tulosteen pitäisi käyttäytyä seuraavanlaisesti:</p>
<div class="language-pwsh-session highlight"><span class="filename">🐳 PowerShell</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="gp">PS&gt; </span><span class="n">pwsh</span> <span class="p">/</span><span class="n">app</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">hello_turbo</span><span class="p">.</span><span class="n">ps1</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="go">========= Turbo Hello World! =========</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="go">Current working directory:     /</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="go">Script directory:              /app/scripts</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="gp">PS&gt; </span><span class="nb">cd </span><span class="n">root</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="gp">PS&gt; </span><span class="nv">$VerbosePreference</span> <span class="p">=</span> <span class="s2">&quot;Continue&quot;</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="gp">PS&gt; </span><span class="n">pwsh</span> <span class="p">/</span><span class="n">app</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">hello_turbo</span><span class="p">.</span><span class="n">ps1</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="go">========= Turbo Hello World! =========</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="go">Current working directory:     /root</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="go">Script directory:              /app/scripts</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="go">VERBOSE: Your PowerShell Edition:       Core</span>
</span></code></pre></div>
<p>Varmista, että osaat tulostaa komennon helpin termiinaaliin.</p>
<details class="tip">
<summary>Vinkki: Get-Help</summary>
<p>Huomaa <code>&lt;# ... #&gt;</code> tiedoston alussa. Tämä on monirivinen kommentti.</p>
</details>
<details class="tip">
<summary>Vinkki: src_path</summary>
<p>Katso <code>about_automatic_variables</code> ja <code>$MyInvocation</code>.</p>
</details>
</details>
<details class="question">
<summary>Tehtävä: Save-Help</summary>
<p>Tehtävänäsi on tallentaa <code>.help/powershell-help</code>-hakemistoon PowerShellin help-tiedostot.</p>
<p>Jos ajoit <a href="../aloita/">PowerShell 101</a>-osion komentoja, huomasit varmasti, että <code>Update-Help</code>-komennon suorittamisessa kestää tovin. Se lataa Help-tiedostot verkosta. Tämä pitäisi ajaa joka kerta uusiksi, kun avaamme PowerShellin konttiin. Nopeutetaan tätä siten, että tallennetaan meille lokaali offline-kopio helpistä.</p>
<p>Skriptissä <code>runpwsh.sh</code> on määritetty bind mount read-write oikeuksin seuraavasti:</p>
<table>
<thead>
<tr>
<th>Host</th>
<th>Container</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.help/powershell-help</code></td>
<td><code>/srv/powershell-help</code></td>
</tr>
</tbody>
</table>
<p>Nyt tehtävänäsi on tallentaa help-tiedostot kontin hakemistoon, joka on bind-mountattu sinun host-koneellesi. Alla on ajettavat komennot. Huomaa, että komennot tulee ajaa kontissa, ei sinun host-koneellasi.</p>
<div class="language-powershell highlight"><span class="filename">🐳 PowerShell</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c"># Create the directory</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="nb">New-Item</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-Path</span> <span class="p">/.</span><span class="n">help</span><span class="p">/</span><span class="n">PowerShellHelp</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="c"># Save the help files</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="nb">Save-Help</span> <span class="n">-DestinationPath</span> <span class="p">/.</span><span class="n">help</span><span class="p">/</span><span class="n">PowerShellHelp</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Vaihtoehtoinen tapa tälle tehtävälle olisi luoda oma Dockerfile ja rakentaa siltä pohjalta image, joka sisältää päivitetyn helpin. Vältellään kuitenkin <code>docker buildx</code>:ää tällä kursilla ja pysytään skriptien ajamisen parissa.</p>
</div>
</details>
<details class="question">
<summary>Tehtävä: gitignore .help</summary>
<p>Lisää lopuksi <code>.help/</code>-hakemisto sinun <code>.gitignore</code>-tiedostoon. Tiedostot ovat aina ladattavissa netistä, joten niiden säilöminen pitkäaikaisesti omana kopiona Gitlabiin olisi turhuutta.</p>
<div class="language-bash highlight"><span class="filename">.gitignore</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># ...ehkä jotain muuta...</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># PowerShell help</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>.help/
</span></code></pre></div>
</details>
<details class="question">
<summary>Tehtävä: localhelp.ps1</summary>
<p>Jatkossa voit instansoida uuden kontin ja ottaa lokaalisti tallennetun helpin käyttöön näin:</p>
<div class="language-powershell highlight"><span class="filename">🐳 PowerShell</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nb">Update-Help</span> <span class="n">-SourcePath</span> <span class="p">/</span><span class="n">srv</span><span class="p">/</span><span class="n">powershell-help</span>
</span></code></pre></div>
<p>Hakemisto on kuitenkin <code>.gitignore</code>-tiedostossa, joten voi olla, että päädyt ajamaan tätä koodia uudella koneella. Siispä on tarpeellista luoda <code>localhelp.ps1</code>-skripti, joka:</p>
<ul>
<li>Päivittää helpin aina, jos <code>-Update</code>-parametri on annettu<ul>
<li>Ajaa: <code>Save-Help -DestinationPath /var/powershell-help</code></li>
</ul>
</li>
<li>Lataa helpin, päivittyi se tai ei.<ul>
<li>Ajaa: <code>Update-Help -SourcePath /var/powershell-help</code></li>
</ul>
</li>
</ul>
</details>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 <a href="https://www.kamk.fi">Kajaanin Ammattikorkeakoulu Oy</a>. 
Licenced under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">BY-NC-ND 4.0</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Kopioitu leikep\u00f6yd\u00e4lle", "clipboard.copy": "Kopioi leikep\u00f6yd\u00e4lle", "search.result.more.one": "1 lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.more.other": "# lis\u00e4\u00e4 t\u00e4ll\u00e4 sivulla", "search.result.none": "Ei t\u00e4sm\u00e4\u00e4vi\u00e4 dokumentteja", "search.result.one": "1 t\u00e4sm\u00e4\u00e4v\u00e4 dokumentti", "search.result.other": "# t\u00e4sm\u00e4\u00e4v\u00e4\u00e4 dokumenttia", "search.result.placeholder": "Kirjoita aloittaaksesi haun", "search.result.term.missing": "Puuttuu", "select.version": "Valitse versio"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>